<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GAME CENTER - FULL SYSTEM</title>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #00D2BE; --secondary: #FFD93D; --accent: #FF6B6B; --bg: #F0F4F8; --card-bg: #FFFFFF; --text: #2D3436; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { font-family: 'Kanit', sans-serif; margin: 0; background: radial-gradient(circle at top right, #E0F7F9, var(--bg)); color: var(--text); height: 100vh; width: 100vw; overflow: hidden; }
        
        /* Animations */
        .btn, .sudoku-cell, #pad button, #global-admin-btn { transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor: pointer; }
        .btn:active, #pad button:active { transform: scale(0.92); opacity: 0.8; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card { animation: fadeIn 0.4s ease-out; }

        .page-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: none; align-items: center; justify-content: center; padding: 20px; z-index: 10; }
        .active-layer { display: flex !important; z-index: 100 !important; }
        .card { background: var(--card-bg); padding: 25px; border-radius: 25px; width: 100%; max-width: 440px; box-shadow: 0 15px 35px rgba(0,210,190,0.15); text-align: center; position: relative; max-height: 90vh; overflow-y: auto; }
        #global-admin-btn { position: fixed; top: 15px; right: 15px; width: 45px; height: 45px; background: white; border-radius: 50%; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; font-size: 22px; z-index: 999; border: 2px solid #EDF2F7; }
        
        .btn { display: block; width: 100%; padding: 14px; border-radius: 15px; border: none; font-family: 'Kanit'; font-weight: 600; font-size: 1rem; margin-top: 10px; }
        .btn-primary { background: linear-gradient(135deg, var(--primary), #00BFA5); color: white; }
        .btn-danger { background: linear-gradient(135deg, var(--accent), #FF5252); color: white; }
        .btn-warning { background: linear-gradient(135deg, #FFD93D, #F6C90E); color: #2D3436; }
        .btn-outline { background: #F1F3F5; color: #4A5568; }
        .btn-sm { padding: 6px 10px; font-size: 0.75rem; width: auto; display: inline-block; margin: 2px; border-radius: 8px; }
        
        input { width: 100%; padding: 15px; border-radius: 12px; border: 2px solid #EDF2F7; text-align: center; font-family: 'Kanit'; font-size: 1.1rem; margin-bottom: 12px; transition: border 0.3s; }
        input:focus { border-color: var(--primary); }
        .hidden { display: none !important; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.85rem; }
        td, th { padding: 10px; border-bottom: 1px solid #F1F3F5; text-align: left; }
        
        .sudoku-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin: 20px 0; background: #EDF2F7; padding: 8px; border-radius: 15px; }
        .sudoku-cell { width: 100%; aspect-ratio: 1; text-align: center; font-size: 1.8rem; border: none; border-radius: 8px; font-weight: bold; color: var(--primary); background: white; }
        .sudoku-cell.locked { background: #F0F4F8; color: #A0AEC0; pointer-events: none; }
        .card-24-num { display: inline-block; width: 60px; height: 60px; line-height: 60px; background: #E0F7F9; color: var(--primary); font-size: 2rem; font-weight: 800; border-radius: 15px; margin: 5px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); animation: fadeIn 0.5s ease-out; }
    </style>
</head>
<body>

    <div id="global-admin-btn" onclick="openAdminAuth()">‚öôÔ∏è</div>

    <div id="layer-welcome" class="page-layer active-layer">
        <div class="card">
            <h1 style="color:var(--primary); font-size: 2.8rem; margin: 0;">GAME CENTER</h1>
            <button class="btn btn-primary" onclick="changeLayer('layer-intro')">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>
        </div>
    </div>

    <div id="layer-intro" class="page-layer">
        <div class="card">
            <h2 style="color:var(--primary);">üë• ‡∏Ñ‡∏ì‡∏∞‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥</h2>
            <div style="text-align:left; font-size:0.9rem; background:#F8FAFC; padding:15px; border-radius:15px; margin-bottom:10px;">
                1. ‡∏î.‡∏ä.‡∏ä‡∏±‡∏¢‡πÄ‡∏°‡∏ò ‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏≠‡∏°‡∏£‡πÄ‡∏ß‡∏ä ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà 2<br>2. ‡∏î.‡∏ä.‡∏ì‡∏±‡∏ê‡∏û‡∏á‡∏©‡πå ‡∏≠‡∏±‡∏á‡∏®‡∏ß‡∏≤‡∏Ñ‡∏° ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà 3<br>
                3. ‡∏î.‡∏ç.‡∏ß‡∏¥‡∏†‡∏≤‡∏î‡∏≤ ‡∏ò‡∏£‡∏£‡∏°‡πÄ‡∏à‡∏£‡∏¥‡∏ç ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà 26<br>4. ‡∏î.‡∏ç.‡∏Å‡∏≤‡∏ô‡∏ï‡∏¥‡πå‡∏ä‡∏ô‡∏¥‡∏ï ‡∏õ‡∏£‡∏∞‡πÄ‡∏™‡∏£‡∏¥‡∏ê‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà 14<br>
                5. ‡∏î.‡∏ç.‡∏ä‡∏ô‡∏¥‡∏™‡∏£‡∏≤ ‡∏ä‡∏∞‡πÄ‡∏≠‡∏° ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà 15
            </div>
            <button class="btn btn-primary" onclick="changeLayer('layer-lock')">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
        </div>
    </div>

    <div id="layer-lock" class="page-layer">
        <div class="card">
            <h2>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h2>
            <div id="lock-content">
                <input type="text" id="p-name" oninput="checkInputName()" placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
                <button id="btn-ready" class="btn btn-primary" onclick="registerPlayer()" disabled style="background:#CBD5E0">‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°</button>
            </div>
            <div id="ready-status" class="hidden">
                <div style="font-size: 4rem;">‚è≥</div>
                <h3>‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°...</h3>
            </div>
            <div id="broadcast-display" class="hidden" style="margin-top:20px; padding:15px; background:#FFF9DB; border-radius:15px; border:2px solid #FFD93D; text-align:left;">
                <b>üì¢ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®:</b> <span id="bc-text-player"></span>
            </div>
        </div>
    </div>

    <div id="layer-admin-auth" class="page-layer" style="background: rgba(0,0,0,0.6);">
        <div class="card">
            <h3>üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin</h3>
            <input type="password" id="admin-pass-input" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
            <button class="btn btn-primary" onclick="checkAdminPass()">‡∏ï‡∏Å‡∏•‡∏á</button>
            <button class="btn btn-outline" onclick="closeAdminAuth()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>
    </div>

    <div id="layer-admin-panel" class="page-layer">
        <div class="card" style="text-align:left;">
            <h3>‚öôÔ∏è Admin Panel</h3>
            <div style="background:#F1F3F5; padding:12px; border-radius:15px; margin-bottom:15px;">
                <b>üì¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</b>
                <input type="text" id="admin-bc-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°..." style="font-size:0.9rem; padding:10px; margin:8px 0; text-align:left;">
                <div style="display:flex; gap:5px;">
                    <button class="btn btn-primary btn-sm" style="flex:1" onclick="sendBroadcast(true)">‡πÄ‡∏õ‡∏¥‡∏î</button>
                    <button class="btn btn-outline btn-sm" style="flex:1" onclick="sendBroadcast(false)">‡∏õ‡∏¥‡∏î</button>
                </div>
            </div>
            <div style="margin-bottom:15px;">
                <b>üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°:</b>
                <button class="btn btn-primary btn-sm" onclick="startGame('MATH')">‡∏™‡∏°‡∏Å‡∏≤‡∏£</button>
                <button class="btn btn-primary btn-sm" style="background:#9F7AEA" onclick="startGame('SUDOKU')">Sudoku</button>
                <button class="btn btn-warning btn-sm" onclick="startGame('GAME24')">Game 24</button>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="btn btn-outline btn-sm" style="flex:1" onclick="loadScores(); changeLayer('layer-scoreboard')">üèÜ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
                <button class="btn btn-danger btn-sm" style="flex:1" onclick="loadBanList(); changeLayer('layer-ban-list')">üö´ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</button>
            </div>
            <button class="btn btn-outline" style="margin-top:10px;" onclick="changeLayer('layer-lock')">‡∏Å‡∏•‡∏±‡∏ö</button>
        </div>
    </div>

    <div id="layer-ban-list" class="page-layer">
        <div class="card">
            <h3>üë• ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</h3>
            <div id="ban-table-body" style="max-height: 350px; overflow-y: auto; text-align: left;"></div>
            <button class="btn btn-outline" style="margin-top:15px;" onclick="changeLayer('layer-admin-panel')">‡∏Å‡∏•‡∏±‡∏ö</button>
        </div>
    </div>

    <div id="layer-countdown" class="page-layer" style="background:white;"><div class="card"><h2>READY...</h2><div id="cd-number" style="font-size:7rem; font-weight:800; color:var(--primary);">5</div></div></div>
    
    <div id="layer-game-math" class="page-layer"><div class="card"><h3>üßÆ ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏™‡∏°‡∏Å‡∏≤‡∏£</h3><div id="math-questions" style="text-align:left; background:#F0FFF9; padding:15px; border-radius:15px;"></div><div id="math-display" style="font-size:2.5rem; font-weight:800; margin:15px; letter-spacing:8px; color:var(--primary);">_ _ _ _</div><div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:8px;" id="pad"></div><button class="btn btn-primary" onclick="submitMath()">‚Üµ ‡∏ï‡∏Å‡∏•‡∏á</button></div></div>
    
    <div id="layer-game-sudoku" class="page-layer"><div class="card"><h3>üß© SUDOKU</h3><div id="sudoku-container" class="sudoku-grid"></div><button class="btn btn-primary" onclick="checkSudoku()">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button></div></div>
    
    <div id="layer-game-24" class="page-layer">
        <div class="card">
            <h3>üßÆ GAME 24</h3>
            <p style="color:#718096; font-size:0.9rem;">‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ 24 ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß</p>
            <div id="game-24-display" style="margin: 15px 0;"></div>
            <input type="text" id="game-24-input" placeholder="‡πÄ‡∏ä‡πà‡∏ô (8-2)*(3+1)">
            <button class="btn btn-warning" onclick="checkGame24()">‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
        </div>
    </div>

    <div id="layer-scoreboard" class="page-layer"><div class="card"><h2>üèÜ Leaderboard</h2><div style="max-height:300px; overflow-y:auto;"><table id="score-table-body"></table></div><button class="btn btn-outline" onclick="changeLayer(myName.toLowerCase()==='admin'?'layer-admin-panel':'layer-lock')">‡∏Å‡∏•‡∏±‡∏ö</button></div></div>
    
    <div id="layer-banned" class="page-layer" style="background:var(--accent); color:white;"><h1>‚õî ‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h1></div>
    <div id="layer-deleted" class="page-layer" style="background:black; color:white;"><h1>üëã ‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡πâ‡∏≠‡∏á</h1><button class="btn btn-primary" onclick="location.reload()">‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</button></div>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyDJf-qOOB_hmP1higooEpMSFe2768dMxfE", databaseURL: "https://mathpasswordgame2-default-rtdb.asia-southeast1.firebasedatabase.app/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let myName = "", correctCode = "", currentCode = "", currentSudokuAns = [], game24Target = [], game24Sol = "";

        function changeLayer(id) { document.querySelectorAll('.page-layer').forEach(l => l.classList.remove('active-layer')); document.getElementById(id).classList.add('active-layer'); }
        function openAdminAuth() { changeLayer('layer-admin-auth'); }
        function closeAdminAuth() { changeLayer('layer-lock'); }
        function checkAdminPass() { if(document.getElementById('admin-pass-input').value === "182137") { myName="admin"; changeLayer('layer-admin-panel'); } }
        function checkInputName() { const v = document.getElementById('p-name').value.trim(); const b = document.getElementById('btn-ready'); b.disabled = v.length < 2; b.style.background = v.length >= 2 ? "var(--primary)" : "#CBD5E0"; }

        function registerPlayer() {
            myName = document.getElementById('p-name').value.trim();
            db.ref('players/' + myName).update({ name: myName, status: 'ready', banned: false, cheat_trigger: 0 });
            
            db.ref('players/' + myName).on('value', s => {
                const p = s.val();
                if(!p) { changeLayer('layer-deleted'); return; }
                if(p.banned) changeLayer('layer-banned');
                else if(p.cheat_trigger && (Date.now() - p.cheat_trigger < 5000)) performCheat();
            });
            document.getElementById('lock-content').classList.add('hidden');
            document.getElementById('ready-status').classList.remove('hidden');
        }

        // --- ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® (Broadcast) ---
        function sendBroadcast(active) { const msg = document.getElementById('admin-bc-input').value; db.ref('system/broadcast').set({ active, message: msg, ts: Date.now() }); }
        db.ref('system/broadcast').on('value', s => {
            const d = s.val(); const box = document.getElementById('broadcast-display');
            if(d && d.active) { box.classList.remove('hidden'); document.getElementById('bc-text-player').innerText = d.message; }
            else box.classList.add('hidden');
        });

        // --- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô (Full Admin) ---
        function loadBanList() {
            db.ref('players').on('value', s => {
                const con = document.getElementById('ban-table-body'); con.innerHTML = "";
                s.forEach(c => {
                    const p = c.val(); if(c.key === 'admin') return;
                    con.innerHTML += `<div style="display:flex; align-items:center; justify-content:space-between; padding:8px; border-bottom:1px solid #EEE;">
                        <span style="font-weight:bold; color:${p.banned?'red':'black'}">${p.name}</span>
                        <div>
                            <button class="btn-sm btn-warning" onclick="sendCheat('${p.name}')">‚ö°</button>
                            <button class="btn-sm ${p.banned?'btn-primary':'btn-danger'}" onclick="toggleBan('${p.name}', ${p.banned})">${p.banned?'‡∏õ‡∏•‡∏î':'‡πÅ‡∏ö‡∏ô'}</button>
                            <button class="btn-sm" style="background:#333; color:white;" onclick="deletePlayer('${p.name}')">‡∏•‡∏ö</button>
                        </div>
                    </div>`;
                });
            });
        }
        function toggleBan(target, status) { db.ref('players/' + target).update({ banned: !status }); }
        function deletePlayer(target) { if(confirm('‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô ' + target + '?')) db.ref('players/' + target).remove(); }
        function sendCheat(target) { db.ref('players/' + target).update({ cheat_trigger: Date.now() }); }

        function performCheat() {
            if(document.getElementById('layer-game-math').classList.contains('active-layer')) {
                currentCode = correctCode; updatePad(); setTimeout(submitMath, 500);
            } else if(document.getElementById('layer-game-sudoku').classList.contains('active-layer')) {
                document.querySelectorAll('.sudoku-cell').forEach((inp, i) => inp.value = currentSudokuAns[i]); setTimeout(checkSudoku, 500);
            } else if(document.getElementById('layer-game-24').classList.contains('active-layer')) {
                document.getElementById('game-24-input').value = game24Sol; alert("‡πÄ‡∏â‡∏•‡∏¢: " + game24Sol); setTimeout(checkGame24, 800);
            }
        }

        // --- Game 24 ---
        function setupGame24() {
            const pool = [{n:[8,3,8,3],s:"8/(3-8/3)"},{n:[6,4,1,1],s:"6*4*1*1"},{n:[5,5,5,1],s:"5*(5-1/5)"},{n:[4,4,10,10],s:"(10*10-4)/4"}];
            const sel = pool[Math.floor(Math.random()*pool.length)];
            game24Target = sel.n; game24Sol = sel.s;
            const dis = document.getElementById('game-24-display'); dis.innerHTML = "";
            game24Target.forEach(n => dis.innerHTML += `<div class="card-24-num">${n}</div>`);
            document.getElementById('game-24-input').value = ""; changeLayer('layer-game-24');
        }
        function checkGame24() {
            const val = document.getElementById('game-24-input').value;
            const used = val.match(/\d+/g); if(!used || used.length !== 4) return alert("‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 4 ‡∏ï‡∏±‡∏ß");
            try {
                if(Math.abs(eval(val) - 24) < 0.1) { finishGame(); alert("‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!"); }
                else alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà 24");
            } catch(e) { alert("‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ú‡∏¥‡∏î"); }
        }

        // --- Core ---
        function startGame(type) { db.ref('system/game_state').set({ type, state: 'COUNTDOWN', ts: Date.now() }); }
        db.ref('system/game_state').on('value', s => {
            const d = s.val(); if(!d || !myName || Date.now()-d.ts > 10000) return;
            if(d.state === 'COUNTDOWN') {
                changeLayer('layer-countdown'); let c=5;
                let t = setInterval(() => {
                    c--; document.getElementById('cd-number').innerText=c;
                    if(c<=0) { clearInterval(t); if(d.type==='MATH') setupMath(); else if(d.type==='SUDOKU') setupSudoku(); else if(d.type==='GAME24') setupGame24(); }
                }, 1000);
            }
        });

        function setupMath() {
            correctCode = "4756"; document.getElementById('math-questions').innerHTML = "1. 2x+3=11<br>2. x-5=2<br>3. 3(x-1)=12<br>4. 10-x=4";
            currentCode = ""; updatePad(); changeLayer('layer-game-math');
            const pad = document.getElementById('pad'); pad.innerHTML = "";
            [1,2,3,4,5,6,7,8,9,'C',0].forEach(n => {
                const b = document.createElement('button'); b.className="btn btn-outline"; b.style.margin="2px"; b.innerText=n;
                b.onclick = () => { if(n==='C') currentCode=""; else if(currentCode.length<4) currentCode+=n; updatePad(); };
                pad.appendChild(b);
            });
        }
        function updatePad() { let r = ""; for(let i=0; i<4; i++) r += (currentCode[i] || "_") + " "; document.getElementById('math-display').innerText = r; }
        function submitMath() { if(currentCode===correctCode) finishGame(); else alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î"); }

        function setupSudoku() { 
            currentSudokuAns=[1,2,3,4,3,4,1,2,2,1,4,3,4,3,2,1];
            const con = document.getElementById('sudoku-container'); con.innerHTML = "";
            [1,0,3,0,0,4,0,2,2,0,4,0,0,3,0,1].forEach((n,i) => {
                const input = document.createElement('input'); input.className="sudoku-cell";
                if(n!==0) { input.value=n; input.classList.add('locked'); }
                con.appendChild(input);
            });
            changeLayer('layer-game-sudoku');
        }
        function checkSudoku() {
            let ok = true; document.querySelectorAll('.sudoku-cell').forEach((inp, i) => { if(parseInt(inp.value)!==currentSudokuAns[i]) ok=false; });
            if(ok) finishGame(); else alert("‡∏ú‡∏¥‡∏î!");
        }

        function finishGame() { db.ref('players/'+myName).update({finishTime:Date.now(), status:'finished'}); changeLayer('layer-lock'); }
        function loadScores() {
            db.ref('players').once('value', s => {
                const tbody = document.getElementById('score-table-body'); tbody.innerHTML = "<tr><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th></tr>";
                s.forEach(c => { if(c.key!=='admin') tbody.innerHTML += `<tr><td>${c.key}</td><td>${c.val().status}</td></tr>`; });
            });
        }
    </script>
</body>
</html>
